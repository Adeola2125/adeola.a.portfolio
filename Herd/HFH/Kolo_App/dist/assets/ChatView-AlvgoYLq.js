import{aw as A,ax as E,e as D,a2 as U,o as n,c as f,b as e,a as h,t as c,P as G,D as J,r as C,R as q,ay as O,f as v,w as a,at as R,au as W,a4 as z,T as I,_ as d,ae as j,av as L,d as o,az as B,E as P,G as p,I as x,af as b,aA as w,aB as k,J as S,p as X,i as T,g as H,h as K,ac as Q,k as Y,V as m,aC as Z,X as ee,ag as ae}from"./index-iwMIQdrE.js";import{_ as $,a as se}from"./VerticalProfileCard.vue_vue_type_script_setup_true_lang-wNi8--Ls.js";async function te(){const t={method:"get",url:"/api/chat",delay:2e3,headers:{"Content-Type":"application/json"}};return await A.request(t)}const le=E("chat",{state:()=>({chats:[],chatContacts:[],profile:null}),actions:{setChats(t){this.chats=t},setChatContacts(t){this.chatContacts=t},setProfile(t){this.profile=t},async initChat(){try{const t=await te(),{data:l}=t,{chats:r,contacts:i}=l;return this.setChats(r),this.setChatContacts(i),this.setProfile(this.profile),Promise.resolve(t)}catch(t){return Promise.reject(t)}}}}),ne={class:"message-item"},re={class:"message-item__text elevation-1"},oe={class:"message-item__meta"},ie={class:"ml-3 text-body-1"},ue=D({__name:"ChatMessage",props:{avatar:{default:""},username:{default:"Johh"},status:{default:"online"},message:{default:""},sentAt:{default:""}},setup(t){const l=t,r=U(),i=()=>(console.log(r.username),l.username===r.username);return(g,V)=>(n(),f("div",{class:J({"d-flex":!0,message:!0,"flex-row-reverse":!i()})},[e($,{size:36,class:"message-avatar",avatar:l.avatar,username:l.username},null,8,["avatar","username"]),h("div",ne,[h("p",re,c(l.message),1),h("div",oe,[e(G,{icon:"mdi-check-all",size:"24",color:"success"}),h("span",ie,c(l.sentAt),1)])])],2))}}),ce={class:"chat-container"},de={ref:"refInputEl",type:"file",name:"file",accept:".jpeg,.png,.jpg,GIF",hidden:""},he=D({__name:"ChatView",setup(t){const l=le(),r=C(!0),i=C(!1),g=q({id:0,username:"",company:"",job:"",country:"",city:"",phone:"",email:"",avatar:"",role:"",status:"active"});O(()=>{l.initChat().then(u=>{r.value=!1}).catch(u=>{r.value=!1})});const V=C([]),F=()=>{console.log("here")},M=u=>{Object.assign(g,u),i.value=!0},N=u=>{V.value=u.messages};return(u,_)=>(n(),v(T,{elevation:"10"},{default:a(()=>[e(R,{class:"chat"},{default:a(()=>[e(W,{width:360,absolute:"",touchless:"",location:"start"},{default:a(()=>[e(z,{flat:"",tag:"div",color:"transparent"},{default:a(()=>[e(I,{class:"mx-5","append-inner-icon":"mdi-magnify"})]),_:1}),e(d),e(j,{lines:"two",class:"pa-0"},{default:a(()=>[e(L,null,{default:a(()=>[o(c(u.$t("recent")),1)]),_:1}),e(d),r.value?(n(),v(B,{key:0,type:"list-item-avatar"})):P("",!0),(n(!0),f(p,null,S(x(l).chats,s=>(n(),f(p,{key:s.id},[e(b,{onClick:y=>N(s),value:s.id},{prepend:a(()=>[e($,{username:s.user?s.user.username:"",avatar:s.user?s.user.avatar:"",size:"40"},null,8,["username","avatar"])]),default:a(()=>[e(w,{class:"ml-3"},{default:a(()=>[o(c(s.user?s.user.username:""),1)]),_:2},1024),e(k,{class:"ml-3"},{default:a(()=>[o(c(s.user?s.user.role:""),1)]),_:2},1024)]),_:2},1032,["onClick","value"]),e(d)],64))),128)),e(L,null,{default:a(()=>[o(c(u.$t("contact")),1)]),_:1}),e(d),r.value?(n(),v(B,{key:1,type:"list-item-avatar"})):P("",!0),(n(!0),f(p,null,S(x(l).chatContacts,s=>(n(),f(p,{key:s.id},[e(b,{onClick:y=>M(s)},{prepend:a(()=>[e($,{username:s.username,avatar:s.avatar,size:"40"},null,8,["username","avatar"])]),default:a(()=>[e(w,{class:"ml-3"},{default:a(()=>[o(c(s.username),1)]),_:2},1024),e(k,{class:"ml-3"},{default:a(()=>[o(c(s.job),1)]),_:2},1024)]),_:2},1032,["onClick"]),e(d)],64))),128))]),_:1})]),_:1}),e(X,null,{default:a(()=>[e(T,{class:"chat-sheet fill-height"},{default:a(()=>[e(z,{class:"px-5",flat:"",tag:"div",color:"transparent"},{default:a(()=>[e(j,null,{default:a(()=>[e(b,{class:"px-0"},{prepend:a(()=>[e(H,{dot:"",location:"bottom right","offset-x":"3","offset-y":"0",bordered:""},{default:a(()=>[e(K,{class:"cursor-pointer"},{default:a(()=>[e(Q,{src:"/assets/images/users/avatar-1.jpg"})]),_:1})]),_:1})]),default:a(()=>[e(w,{class:"ml-3"},{default:a(()=>[o("Michael")]),_:1}),e(k,{class:"ml-3"},{default:a(()=>[o("Wang")]),_:1})]),_:1})]),_:1}),e(Y),e(m,{icon:"mdi-video-outline",size:"36",density:"comfortable"}),e(m,{icon:"mdi-phone-outline",size:"36",density:"comfortable"}),e(m,{icon:"mdi-magnify",size:"36",density:"comfortable"})]),_:1}),e(d),h("div",ce,[e(x(Z),{tag:"div",class:"chat-scroll"},{default:a(()=>[(n(!0),f(p,null,S(V.value,(s,y)=>(n(),v(ue,{key:y,avatar:s.sender?s.sender.avatar:"",username:s.sender?s.sender.username:"","sent-at":s.time,message:s.message},null,8,["avatar","username","sent-at","message"]))),128))]),_:1})]),e(ee,{class:"chat-form mb-5 mx-5"},{default:a(()=>[e(I,{variant:"solo",class:"chat-message-input",placeholder:"Type your message...",density:"default",autofocus:""},{"append-inner":a(()=>[e(m,{height:"36",width:"36",density:"comfortable",icon:"mdi-image-outline",variant:"text"}),e(m,{height:"36",width:"36",density:"comfortable",class:"mx-2",icon:"mdi-phone-outline",variant:"text"}),e(m,{onClick:F},{default:a(()=>[o("Send")]),_:1})]),_:1}),h("input",de,null,512)]),_:1})]),_:1})]),_:1})]),_:1}),e(ae,{modelValue:i.value,"onUpdate:modelValue":_[1]||(_[1]=s=>i.value=s),width:"640px",eager:""},{default:a(()=>[e(se,{user:g,"onForm:cancel":_[0]||(_[0]=s=>i.value=!1)},null,8,["user"])]),_:1},8,["modelValue"])]),_:1}))}});export{he as default};
